<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design Feedback Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="header-title">
                    <img src="https://images.squarespace-cdn.com/content/654eaa35544df93addc9876a/1622dd2d-880e-43ab-b94e-fbc7f9be3f28/MDM+Logo+Blue+to+Pink+Gradient.png?content-type=image%2Fpng" alt="MDM Logo" class="header-logo">
                    <div class="header-text">
                        <h1>Design Feedback Dashboard</h1>
                        <p>Review designs and provide feedback</p>
                    </div>
                </div>
            </div>
            <button class="btn btn-secondary" onclick="toggleAdmin()" style="font-size: 14px;">üîí Admin</button>
        </div>

        <!-- Admin Panel (Hidden by default) -->
        <div id="admin-panel" class="admin-panel">
            <h2 style="margin-bottom: 24px; color: #3b82f6;">üîí Admin Panel</h2>
            
            <div class="form-group">
                <label for="client-name">Client Name</label>
                <input type="text" id="client-name" placeholder="Enter client name">
            </div>

            <div class="form-group">
                <label for="page-name">Page Name</label>
                <input type="text" id="page-name" placeholder="Enter page name (e.g., homepage, about)">
            </div>

            <div class="form-group">
                <label for="page-version">Version</label>
                <input type="text" id="page-version" placeholder="e.g., 1.0, 2.1" value="1.0">
            </div>

            <div class="form-group">
                <label for="page-url">Page URL (optional)</label>
                <input type="text" id="page-url" placeholder="domain.com/page-name">
                <small style="color: #6b7280; font-size: 14px;">
                    Just enter the domain - "https://" will be added automatically
                </small>
            </div>

            <div class="form-group">
                <label for="page-access-password">Access Password (optional)</label>
                <input type="password" id="page-access-password" placeholder="Password for clients to view this page">
                <small style="color: #6b7280; font-size: 14px;">
                    Leave blank if no password protection needed
                </small>
            </div>

            <div class="form-group">
                <label>Page Source</label>
                <div style="margin-bottom: 16px;">
                    <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                        <button type="button" class="btn btn-secondary" id="upload-tab" onclick="switchSourceTab('upload')" style="flex: 1;">üìÅ Upload Image</button>
                        <button type="button" class="btn btn-secondary" id="screenshot-tab" onclick="switchSourceTab('screenshot')" style="flex: 1;">üåê Screenshot URL</button>
                    </div>
                </div>
                
                <!-- Upload Image Option -->
                <div id="upload-option" class="source-option">
                    <div class="file-upload" id="file-upload">
                        <div>
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                <circle cx="8.5" cy="8.5" r="1.5"/>
                                <polyline points="21,15 16,10 5,21"/>
                            </svg>
                            <p style="margin: 12px 0; font-weight: 500;">Click to upload or drag and drop</p>
                            <p style="color: #6b7280; font-size: 14px;">PNG, JPG, GIF up to 5MB</p>
                        </div>
                        <input type="file" id="image-upload" accept="image/*" style="display: none;">
                    </div>
                </div>
                
                <!-- Screenshot URL Option -->
                <div id="screenshot-option" class="source-option" style="display: none;">
                    <div style="margin-bottom: 16px;">
                        <label for="screenshot-url">Website URL</label>
                        <input type="text" id="screenshot-url" placeholder="example.com or site.squarespace.com" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px;">
                        <small style="color: #6b7280; font-size: 12px; display: block; margin-top: 4px;">
                            Just enter the domain - "https://" will be added automatically
                        </small>
                    </div>
                    
                    <div style="margin-bottom: 16px;">
                        <label for="screenshot-password">Site Password (if required)</label>
                        <input type="password" id="screenshot-password" placeholder="Enter password for protected sites" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px;">
                        <small style="color: #6b7280; font-size: 12px; display: block; margin-top: 4px;">
                            Leave blank if site is not password protected
                        </small>
                    </div>
                    
                    <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                        <div style="flex: 1;">
                            <label for="screenshot-fullpage">Screenshot Type</label>
                            <select id="screenshot-fullpage" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px;">
                                <option value="true">Full Page</option>
                                <option value="false">Viewport Only</option>
                            </select>
                        </div>
                        <div style="flex: 1;">
                            <label for="screenshot-device">Device Size</label>
                            <select id="screenshot-device" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px;">
                                <option value="desktop">Desktop (1920x1080)</option>
                                <option value="tablet">Tablet (768x1024)</option>
                                <option value="mobile">Mobile (375x667)</option>
                            </select>
                        </div>
                    </div>
                    
                    <button type="button" class="btn btn-secondary" onclick="previewScreenshot()" style="width: 100%; margin-bottom: 16px;">
                        üì∑ Preview Screenshot
                    </button>
                    
                    <div id="screenshot-preview" style="display: none; margin-top: 16px; text-align: center;">
                        <p style="color: #6b7280; margin-bottom: 8px;">Preview:</p>
                        <img id="screenshot-preview-img" style="max-width: 100%; max-height: 300px; border: 1px solid #e2e8f0; border-radius: 8px;">
                    </div>
                </div>
            </div>

            <button class="btn btn-primary" onclick="uploadPage()">Upload Page</button>

            <div style="margin-top: 40px;">
                <h3>Existing Pages</h3>
                <div id="admin-pages-list" style="margin-top: 16px;">
                    <!-- Pages will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Client Selector -->
        <div class="client-selector">
            <h2 style="margin-bottom: 16px;">Enter Your Client Portal</h2>
            <div class="form-group">
                <label for="client-access">Client Name</label>
                <input type="text" id="client-access" placeholder="Enter your client name" 
                       onkeypress="if(event.key==='Enter') loadClientDashboard()">
                <button class="btn btn-primary" onclick="loadClientDashboard()" style="margin-top: 8px;">Access Dashboard</button>
            </div>
        </div>

        <!-- Client Dashboard -->
        <div id="client-dashboard" style="display: none;">
            <div class="client-dashboard">
                <div class="client-name" id="client-display-name"></div>
                <div class="client-info" id="client-info"></div>
                
                <div id="pages-container">
                    <div class="pages-grid" id="pages-grid">
                        <!-- Pages will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Page Viewer -->
        <div id="page-viewer" style="display: none;">
            <button class="btn btn-secondary back-btn" onclick="backToDashboard()">‚Üê Back to Dashboard</button>
            
            <!-- Toolbar -->
            <div class="toolbar">
                <button class="tool-btn active" id="pin-tool" onclick="selectTool('pin')">üìç Pin Comment</button>
                <button class="tool-btn" id="draw-tool" onclick="selectTool('draw')">‚úèÔ∏è Draw</button>
                <button class="tool-btn" onclick="clearDrawing()">üóëÔ∏è Clear Drawing</button>
                <button class="tool-btn" id="live-url-btn" onclick="openLiveUrl()" style="display: none;">üîó View Live URL</button>
                <span id="page-password-display" style="display: none; margin-left: 16px; padding: 8px 12px; background: #f3f4f6; border-radius: 6px; font-size: 14px; color: #374151;">
                    PW: <span id="password-text"></span>
                </span>
                <div style="margin-left: auto; display: flex; gap: 12px; align-items: center;">
                    <button class="btn btn-success" onclick="markAsCompleted()" id="complete-btn">‚úì Mark Complete</button>
                    <select id="version-selector" onchange="loadVersion()">
                        <option value="">Select Version</option>
                    </select>
                </div>
            </div>

            <!-- Whiteboard container -->
            <div class="whiteboard-container">
                <img id="page-image" class="whiteboard-image" src="" alt="Page design">
                <div id="image-overlay" class="image-overlay active"></div>
                <canvas id="drawing-canvas" class="drawing-canvas"></canvas>
            </div>

            <!-- Comments panel -->
            <div class="comments-panel">
                <h3>All Comments</h3>
                <div id="comments-list">
                    <!-- Comments will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading...</div>
    </div>

    <!-- Comment Modal -->
    <div id="comment-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Comment</h3>
                <button class="close-btn" onclick="closeCommentModal()">&times;</button>
            </div>
            <div style="margin-bottom: 16px;">
                <label for="comment-text">Comment</label>
                <textarea id="comment-text" class="comment-input" placeholder="Enter your feedback..."></textarea>
            </div>
            <div style="display: flex; gap: 12px;">
                <button class="btn btn-primary" onclick="saveComment()">Save Comment</button>
                <button class="btn btn-secondary" onclick="closeCommentModal()">Cancel</button>
                <button class="btn btn-danger" id="delete-comment-btn" onclick="deleteComment()" style="display: none;">Delete Comment</button>
            </div>
        </div>
    </div>

    <!-- External JavaScript -->
    <script src="app.js"></script>
</body>
</html>
